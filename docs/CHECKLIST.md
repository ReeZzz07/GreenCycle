# Checklist функциональности GreenCycle

## Общая информация

**Проект:** GreenCycle  
**Версия:** 1.0  
**Дата проверки:** ___________  
**Проверяющий:** ___________  

## Аутентификация и авторизация

### Базовая функциональность
- [ ] Вход в систему с email и паролем
- [ ] Выход из системы
- [ ] Обновление access token через refresh token
- [ ] Автоматическое перенаправление на страницу входа при отсутствии авторизации
- [ ] Защита маршрутов от неавторизованного доступа
- [ ] Проверка прав доступа по ролям

### Роли и права
- [ ] Роль "super_admin" - полный доступ
- [ ] Роль "admin" - полный доступ к бизнес-модулям
- [ ] Роль "manager" - доступ к клиентам, продажам, выкупам
- [ ] Роль "accountant" - доступ к финансам, отчётам
- [ ] Роль "logistic" - доступ к закупкам, складу

## Модуль "Закупки"

### Поставщики
- [ ] Создание поставщика
- [ ] Просмотр списка поставщиков
- [ ] Поиск поставщиков
- [ ] Редактирование поставщика
- [ ] Удаление поставщика

### Поставки
- [ ] Создание поставки
- [ ] Просмотр списка поставок
- [ ] Просмотр деталей поставки
- [ ] Добавление партий к поставке
- [ ] Автоматический расчёт общей стоимости поставки
- [ ] Скачивание накладной в PDF

### Партии
- [ ] Регистрация партии с параметрами (тип растения, размер, горшок, количество, цена)
- [ ] Автоматическое обновление остатков на складе
- [ ] Привязка партии к поставке

## Модуль "Склад"

### Остатки
- [ ] Просмотр остатков по партиям
- [ ] Отображение текущего и начального количества
- [ ] Фильтрация по типу растения, размеру, горшку
- [ ] Автоматическое обновление остатков при продажах и выкупах

### Списания
- [ ] Создание списания
- [ ] Указание причины списания
- [ ] Автоматическое обновление остатков при списании
- [ ] Просмотр списка списаний
- [ ] Фильтрация списаний по дате, партии, причине

## Модуль "Клиенты"

### Управление клиентами
- [ ] Создание клиента
- [ ] Просмотр списка клиентов
- [ ] Поиск клиентов
- [ ] Редактирование клиента
- [ ] Удаление клиента
- [ ] Хранение контактной информации, адреса, ИНН

### История клиентов
- [ ] Просмотр истории продаж клиента
- [ ] Просмотр истории выкупов клиента
- [ ] Отображение общей суммы покупок клиента

## Модуль "Продажи"

### Создание продажи
- [ ] Выбор клиента (или создание нового)
- [ ] Указание даты продажи
- [ ] Добавление позиций (партия, количество, цена)
- [ ] Автоматический расчёт общей суммы
- [ ] Валидация наличия товара на складе
- [ ] Автоматическое обновление остатков на складе
- [ ] Автоматическое создание финансовой транзакции
- [ ] Автоматическое создание задачи на выкуп

### Управление продажами
- [ ] Просмотр списка продаж
- [ ] Просмотр деталей продажи
- [ ] Отмена продажи
- [ ] Автоматическое возвращение товаров на склад при отмене
- [ ] Автоматическая отмена финансовой транзакции при отмене
- [ ] Скачивание счёта в PDF

## Модуль "Выкуп"

### Создание выкупа
- [ ] Выбор исходной продажи
- [ ] Выбор клиента
- [ ] Указание планируемой даты выкупа
- [ ] Добавление позиций (позиция из продажи, количество, цена выкупа, состояние)
- [ ] Валидация количества (не больше, чем в исходной продаже)
- [ ] Автоматическое создание уведомлений (60, 30, 7 дней до выкупа)
- [ ] Автоматическая отправка email уведомлений (если настроено)

### Управление выкупами
- [ ] Просмотр списка выкупов
- [ ] Фильтрация по статусу (planned, contacted, declined, completed)
- [ ] Просмотр деталей выкупа
- [ ] Редактирование выкупа
- [ ] Завершение выкупа
- [ ] Отклонение выкупа
- [ ] Автоматическое обновление остатков на складе при завершении
- [ ] Автоматическое создание финансовой транзакции при завершении
- [ ] Скачивание акта выкупа в PDF

## Модуль "Финансы"

### Счета
- [ ] Создание счёта (название, тип, начальный баланс)
- [ ] Просмотр списка счетов
- [ ] Просмотр деталей счёта
- [ ] Редактирование счёта
- [ ] Удаление счёта
- [ ] Автоматический расчёт баланса
- [ ] Пересчёт баланса вручную

### Транзакции
- [ ] Создание транзакции (счёт, тип, сумма, описание)
- [ ] Просмотр списка транзакций
- [ ] Фильтрация по счёту, типу, дате
- [ ] Просмотр деталей транзакции
- [ ] Удаление транзакции
- [ ] Автоматическое обновление баланса счёта
- [ ] Привязка транзакции к продаже или выкупу

### Изъятия партнёров
- [ ] Создание изъятия (счёт, сумма, описание)
- [ ] Просмотр списка изъятий
- [ ] Просмотр деталей изъятия
- [ ] Автоматическое обновление баланса счёта
- [ ] Отслеживание создателя изъятия

## Модуль "Отчёты"

### Прибыль по поставкам
- [ ] Фильтрация по дате (начальная и конечная дата)
- [ ] Отображение прибыли по каждой поставке
- [ ] Расчёт маржи
- [ ] Экспорт в Excel

### Прибыль по клиентам
- [ ] Фильтрация по дате (начальная и конечная дата)
- [ ] Отображение прибыли по каждому клиенту
- [ ] Расчёт маржи
- [ ] Экспорт в Excel

### Прогноз выкупа
- [ ] Фильтрация по дате (начальная и конечная дата)
- [ ] Отображение прогноза выкупа
- [ ] Расчёт потенциальной прибыли
- [ ] Экспорт в Excel

### Движение средств
- [ ] Фильтрация по дате (начальная и конечная дата)
- [ ] Отображение движения средств по счетам
- [ ] Расчёт баланса
- [ ] Экспорт в Excel

### Активность клиентов
- [ ] Фильтрация по дате (начальная и конечная дата)
- [ ] Отображение активности клиентов
- [ ] Расчёт общей суммы покупок
- [ ] Экспорт в Excel

### Сводка по складу
- [ ] Отображение остатков по партиям
- [ ] Расчёт общей стоимости остатков
- [ ] Экспорт в Excel

## Модуль "Уведомления"

### Управление уведомлениями
- [ ] Просмотр списка уведомлений
- [ ] Фильтрация по прочитанности
- [ ] Просмотр деталей уведомления
- [ ] Отметка как прочитанное
- [ ] Отметка всех как прочитанные
- [ ] Удаление уведомления
- [ ] Отображение количества непрочитанных уведомлений

### Автоматические уведомления
- [ ] Создание уведомлений о выкупе (60, 30, 7 дней до планируемой даты)
- [ ] Отправка email уведомлений (если настроено)
- [ ] Ежедневная проверка выкупов (cron задача)

## Модуль "Профиль"

### Управление профилем
- [ ] Просмотр информации о профиле
- [ ] Смена пароля
- [ ] Отображение роли пользователя

## PDF генерация

### Документы
- [ ] Генерация счёта продажи в PDF
- [ ] Генерация накладной поставки в PDF
- [ ] Генерация акта выкупа в PDF
- [ ] Правильное форматирование документов
- [ ] Поддержка русского языка в PDF

## Excel экспорт

### Отчёты
- [ ] Экспорт прибыли по поставкам в Excel
- [ ] Экспорт прибыли по клиентам в Excel
- [ ] Экспорт прогноза выкупа в Excel
- [ ] Экспорт движения средств в Excel
- [ ] Экспорт активности клиентов в Excel
- [ ] Правильное форматирование данных в Excel

## PWA функции

### Установка
- [ ] Возможность установки на домашний экран
- [ ] Корректное отображение иконок
- [ ] Корректное отображение manifest.json

### Offline режим
- [ ] Работа в offline режиме
- [ ] Кэширование статических ресурсов
- [ ] Кэширование API запросов
- [ ] Очередь offline запросов
- [ ] Автоматическая синхронизация при восстановлении соединения
- [ ] Индикация offline статуса

### Service Worker
- [ ] Регистрация service worker
- [ ] Автоматическое обновление приложения
- [ ] Кэширование статических ресурсов
- [ ] Кэширование API запросов
- [ ] Стратегии кэширования (CacheFirst, NetworkFirst)

## Email уведомления

### SMTP интеграция
- [ ] Настройка SMTP (опционально)
- [ ] Отправка email уведомлений о выкупе
- [ ] HTML шаблоны писем
- [ ] Логирование отправок
- [ ] Обработка ошибок отправки

## Фоновые задачи

### Cron задачи
- [ ] Ежедневная проверка выкупов (9:00)
- [ ] Создание уведомлений о выкупе (60, 30, 7 дней до планируемой даты)
- [ ] Отправка email уведомлений

## Производительность

### Backend
- [ ] Быстрая загрузка страниц (< 1.5 с)
- [ ] Оптимизация запросов к базе данных
- [ ] Использование индексов
- [ ] Кэширование запросов
- [ ] Транзакции для критических операций
- [ ] Pessimistic locking для обновления остатков

### Frontend
- [ ] Быстрая загрузка страниц
- [ ] Оптимизация bundle size
- [ ] Lazy loading компонентов
- [ ] Кэширование через TanStack Query
- [ ] Service Worker для кэширования

## Безопасность

### Backend
- [ ] JWT токены с коротким временем жизни
- [ ] Refresh tokens для обновления access tokens
- [ ] Password hashing с bcrypt
- [ ] RBAC (Role-Based Access Control)
- [ ] Валидация всех входных данных
- [ ] Защита от SQL инъекций (TypeORM)
- [ ] CORS настройки

### Frontend
- [ ] Хранение токенов в localStorage
- [ ] Автоматическое обновление токенов
- [ ] Защита маршрутов (ProtectedRoute)
- [ ] Валидация форм
- [ ] Обработка ошибок

## Аудит

### Отслеживание изменений
- [ ] Отслеживание created_by_id для всех сущностей
- [ ] Отслеживание updated_by_id для всех сущностей
- [ ] Отслеживание created_at для всех сущностей
- [ ] Отслеживание updated_at для всех сущностей

## Валидация данных

### Формы
- [ ] Валидация всех полей форм
- [ ] Отображение ошибок валидации
- [ ] Проверка обязательных полей
- [ ] Проверка формата данных (email, дата, число)

### Backend
- [ ] Валидация всех DTO
- [ ] Проверка прав доступа
- [ ] Проверка существования связанных сущностей
- [ ] Проверка бизнес-правил

## Обработка ошибок

### Backend
- [ ] Глобальный exception filter
- [ ] Правильные коды ошибок (400, 401, 403, 404, 500)
- [ ] Понятные сообщения об ошибках
- [ ] Логирование ошибок

### Frontend
- [ ] Обработка ошибок API
- [ ] Отображение сообщений об ошибках пользователю
- [ ] Обработка offline ошибок
- [ ] Обработка ошибок валидации

## Тестирование

### Функциональное тестирование
- [ ] Тестирование всех модулей
- [ ] Тестирование всех API endpoints
- [ ] Тестирование всех форм
- [ ] Тестирование всех отчётов

### Интеграционное тестирование
- [ ] Тестирование взаимодействия между модулями
- [ ] Тестирование транзакций
- [ ] Тестирование автоматических обновлений

### Тестирование производительности
- [ ] Тестирование загрузки страниц
- [ ] Тестирование запросов к базе данных
- [ ] Тестирование кэширования

## Документация

### Техническая документация
- [ ] Документация по API
- [ ] Документация по структуре БД
- [ ] Документация по модулям и интеграциям

### Пользовательская документация
- [ ] Инструкции для администраторов
- [ ] Инструкции для менеджеров
- [ ] Инструкции для бухгалтеров
- [ ] Инструкции для логистов

## Деплой

### Backend
- [ ] Сборка проекта
- [ ] Запуск миграций
- [ ] Запуск приложения
- [ ] Настройка переменных окружения
- [ ] Настройка SMTP (опционально)

### Frontend
- [ ] Сборка проекта
- [ ] Деплой статических файлов
- [ ] Настройка переменных окружения
- [ ] Настройка PWA

## Заключение

**Общее количество проверенных пунктов:** ___ / ___  
**Количество пройденных проверок:** ___ / ___  
**Количество проваленных проверок:** ___ / ___  

**Комментарии:**  
_____________________________________________________________________________
_____________________________________________________________________________
_____________________________________________________________________________

**Дата завершения проверки:** ___________  
**Подпись проверяющего:** ___________  

